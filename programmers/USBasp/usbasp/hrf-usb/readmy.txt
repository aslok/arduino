Страничка проекта http://homes-smart.ru/index.php/oborudovanie/bez-provodov-2-4-ggts/50-nrf24l01-usb

Индикация работы устройства:

Бывший программатор USBasp имеет 2 встроенных светодиодов которые показывают активность:

Светодиод R (дальний  от перемычки JP2) -общая активность работы.

Светодиод G (ближний к перемычкеJP2) -мигает при приеме данных.

Настройка и работа с устройством.

Для приема/отправки данных и для настройки нам будет необходима консольная утилита nRF-USB .В архиве проекта имеется исходный код утилиты и откомпилированный вариант утилиты под windows.

При вызове утилиты без параметров будут выведены основные команды.

Команды отправки и приема:

nRF-USB read <номер радиомодуля> - выдает строку данных данного клиента через разделитель - точку с запятой.

nRF-USB write <номер радиомодуля> <массив данных до 4 однобайтовых цифр> - отправка данных.На клиента можно отправить до 4 байт одновременно.Например: nRF-USB write 1 10 7 1 1 - что значит установить на 7 выводе логический уровень 1 на клиенте 1.

Команды настройки:

nRF-USB status - выдает некоторую информацию о устройстве.

nRF-USB setupch <номер канала> - установка канала от 0 до 125.Можно задавать и в виде частоты 2400..2525 мгц.Выбранный канал не должен пересекатся с другими радиоустройствами,например с wi-fi или радиотелефонами.Канал по умолчанию - 25.

 nRF-USB setupcount <количество клиентов> - установка максимального количества клиентов,по умолчанию установлен 1 клиент.Не устанавливайте большее количество клиентов,чем на самом деле - иначе будут паузы при передаче данных.

nRF-USB setupspeed <скорость> -установка скорости.Необходимо ввести цифру соотвествующую скорости: 1 -2MBit/s ,2 -1MBit/s , 3 -250kBit/s.По умолчанию установлена скорость 1 мегабит/с.

nRF-USB setupautoack <статус> - установка аппаратного потверждения.Возможные опции: 0 - выключить потверждение, 1 - включить потверждение.По умолчанию включено.

Все опции настроек сохраняются в энергонезависимой памяти.Команды без опций выводит текущие состояния.

Для успешной работы на клиентах должны установлены аналогичные параметры скорости,канала и аппаратного потверждения.

Утилита может использоватся как внешний модуль для системы умного дома и других программ,или исходный код может быть интегрирован в другие программы.

Отладочные команды для опытных пользователей:

nRF-USB readreg <адрес регистра> - выводит данные текущего регистра nRF24L01.Например команда nRF-USB readreg 5 выведет текущий установленный канал из регистра RF_CH радиомодуля.

nRF-USB writereg <адрес регистра> <1 байт данных> - записывает данные в регистр nRF24L01.Например команда nRF-USB writereg 5 95 устанавливает 95 канал в обход команды nRF-USB setupch -соотвественно без сохранения настроек. 
